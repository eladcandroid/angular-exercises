<div class="drag-drop-task-list">
  <div class="drag-drop-header">
    <span class="drag-icon">â†•ï¸</span>
    <span>×’×¨×•×¨ ×•×”×–×– ××©×™××•×ª ×œ×¡×™×“×•×¨ ××—×“×©</span>
  </div>

  <div
    cdkDropList
    class="tasks-container"
    (cdkDropListDropped)="onDrop($event)"
  >
    @for (task of tasks(); track task.id) {
      <div
        cdkDrag
        class="task-item"
        [class.completed]="task.completed"
        [class.overdue]="isOverdue(task)"
      >
        <!-- Drag Handle -->
        <div class="drag-handle" cdkDragHandle>
          <span class="handle-icon">â‹®â‹®</span>
        </div>

        <!-- Drag Placeholder -->
        <div class="task-placeholder" *cdkDragPlaceholder>
          <div class="placeholder-content">
            ×”×–×– ×œ×›××Ÿ...
          </div>
        </div>

        <!-- Task Content -->
        <div class="task-content">
          <!-- Checkbox -->
          <div class="task-checkbox">
            <input
              type="checkbox"
              [checked]="task.completed"
              (change)="onToggle(task.id)"
              [id]="'task-' + task.id"
            />
            <label [for]="'task-' + task.id"></label>
          </div>

          <!-- Task Info -->
          <div class="task-info">
            <div class="task-header">
              <h3 class="task-title">{{ task.title }}</h3>
              <span class="priority-badge" [class]="getPriorityClass(task.priority)">
                @if (task.priority === 'high') {
                  ğŸ”´ ×’×‘×•×”
                } @else if (task.priority === 'medium') {
                  ğŸŸ¡ ×‘×™× ×•× ×™
                } @else {
                  ğŸŸ¢ × ××•×š
                }
              </span>
            </div>

            @if (task.description) {
              <p class="task-description">{{ task.description }}</p>
            }

            <div class="task-meta">
              <span class="task-category">ğŸ“ {{ task.category }}</span>

              @if (task.dueDate) {
                <span class="task-due-date" [class.overdue]="isOverdue(task)">
                  @if (isOverdue(task)) {
                    âš ï¸
                  } @else {
                    ğŸ“…
                  }
                  {{ formatDate(task.dueDate) }}
                </span>
              }

              @if (task.tags && task.tags.length > 0) {
                <div class="task-tags">
                  @for (tag of task.tags; track tag) {
                    <span class="tag">#{{ tag }}</span>
                  }
                </div>
              }
            </div>
          </div>

          <!-- Actions -->
          <div class="task-actions">
            <button
              class="btn-edit"
              (click)="onEdit(task)"
              title="×¢×¨×™×›×”"
            >
              âœï¸
            </button>
            <button
              class="btn-delete"
              (click)="onDelete(task.id)"
              title="××—×™×§×”"
            >
              ğŸ—‘ï¸
            </button>
          </div>
        </div>

        <!-- Drag Preview -->
        <div class="task-preview" *cdkDragPreview>
          <div class="preview-content">
            <span class="drag-icon-preview">â†•ï¸</span>
            <span>{{ task.title }}</span>
          </div>
        </div>
      </div>
    } @empty {
      <div class="empty-list">
        <p>××™×Ÿ ××©×™××•×ª ×œ×”×¦×’×”</p>
      </div>
    }
  </div>
</div>
